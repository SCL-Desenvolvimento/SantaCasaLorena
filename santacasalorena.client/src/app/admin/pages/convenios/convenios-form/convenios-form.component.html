
<div class="convenios-form-container">
  <!-- Page Header -->
  <div class="page-header mb-4">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h2 class="page-title mb-1">
          {{ isEditMode ? 'Editar Convênio' : 'Novo Convênio' }}
        </h2>
        <p class="page-subtitle text-muted mb-0">
          {{ isEditMode ? 'Edite as informações do convênio existente' : 'Preencha os dados para cadastrar um novo convênio' }}
        </p>
      </div>
      <button 
        class="btn btn-outline-secondary"
        (click)="cancel()">
        <i class="bi bi-arrow-left me-2"></i>
        Voltar
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="text-center py-5" *ngIf="loading">
    <app-loading-spinner message="Carregando convênio..."></app-loading-spinner>
  </div>

  <!-- Convenio Form -->
  <div class="card shadow-sm border-0 rounded-3" *ngIf="!loading">
    <div class="card-body">
      <form [formGroup]="convenioForm" (ngSubmit)="save()">
        <div class="row">
          <div class="col-md-8">
            <!-- Title -->
            <div class="mb-3">
              <label for="name" class="form-label">Título do Convênio <span class="text-danger">*</span></label>
              <input 
                type="text" 
                class="form-control"
                [class.is-invalid]="isFieldInvalid('name')"
                id="name" 
                formControlName="name"
                placeholder="Ex: Convênio para material escolar">
              <div class="invalid-feedback" *ngIf="isFieldInvalid('name')">
                {{ getFieldError('name') }}
              </div>
            </div>

            <!-- Description -->
            <div class="mb-3">
              <label for="description" class="form-label">Descrição <span class="text-danger">*</span></label>
              <textarea 
                class="form-control"
                [class.is-invalid]="isFieldInvalid('description')"
                id="description" 
                formControlName="description"
                rows="5"
                placeholder="Descreva o objetivo e os termos do convênio..."></textarea>
              <div class="invalid-feedback" *ngIf="isFieldInvalid('description')">
                {{ getFieldError('description') }}
              </div>
            </div>

            <!-- Partner -->
            <div class="mb-3">
              <label for="partner" class="form-label">Parceiro <span class="text-danger">*</span></label>
              <input 
                type="text" 
                class="form-control"
                [class.is-invalid]="isFieldInvalid('partner')"
                id="partner" 
                formControlName="partner"
                placeholder="Ex: Editora ABC">
              <div class="invalid-feedback" *ngIf="isFieldInvalid('partner')">
                {{ getFieldError('partner') }}
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <!-- Category -->
            <div class="mb-3">
              <label for="category" class="form-label">Categoria <span class="text-danger">*</span></label>
              <select 
                class="form-select"
                [class.is-invalid]="isFieldInvalid('category')"
                id="category" 
                formControlName="category">
                <option value="">Selecione uma categoria</option>
                <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
              </select>
              <div class="invalid-feedback" *ngIf="isFieldInvalid('category')">
                {{ getFieldError('category') }}
              </div>
            </div>

            <!-- Status -->
            <div class="mb-3">
              <label for="status" class="form-label">Status <span class="text-danger">*</span></label>
              <select 
                class="form-select"
                [class.is-invalid]="isFieldInvalid('status')"
                id="status" 
                formControlName="status">
                <option *ngFor="let s of statuses" [value]="s.value">{{ s.label }}</option>
              </select>
              <div class="invalid-feedback" *ngIf="isFieldInvalid('status')">
                {{ getFieldError('status') }}
              </div>
            </div>

            <!-- Start Date -->
            <div class="mb-3">
              <label for="startDate" class="form-label">Data de Início <span class="text-danger">*</span></label>
              <input 
                type="date" 
                class="form-control"
                [class.is-invalid]="isFieldInvalid('startDate')"
                id="startDate" 
                formControlName="startDate">
              <div class="invalid-feedback" *ngIf="isFieldInvalid('startDate')">
                {{ getFieldError('startDate') }}
              </div>
            </div>

            <!-- End Date -->
            <div class="mb-3">
              <label for="endDate" class="form-label">Data de Término <span class="text-danger">*</span></label>
              <input 
                type="date" 
                class="form-control"
                [class.is-invalid]="isFieldInvalid('endDate')"
                id="endDate" 
                formControlName="endDate">
              <div class="invalid-feedback" *ngIf="isFieldInvalid('endDate')">
                {{ getFieldError('endDate') }}
              </div>
            </div>

            <!-- Value -->
            <div class="mb-3">
              <label for="value" class="form-label">Valor (R$) <span class="text-danger">*</span></label>
              <input 
                type="number" 
                class="form-control"
                [class.is-invalid]="isFieldInvalid('value')"
                id="value" 
                formControlName="value"
                placeholder="0.00">
              <div class="invalid-feedback" *ngIf="isFieldInvalid('value')">
                {{ getFieldError('value') }}
              </div>
            </div>
          </div>
        </div>

        <div class="d-flex justify-content-end mt-4">
          <button 
            type="button" 
            class="btn btn-outline-secondary me-2"
            (click)="cancel()">
            Cancelar
          </button>
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="saving">
            <span *ngIf="saving" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
            {{ saving ? 'Salvando...' : 'Salvar Convênio' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

